---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { db } from '../../lib/db/client';
import { venues } from '../../lib/db/schema';
import { eq } from 'drizzle-orm';
import BookingForm from '../../components/BookingForm';
import Card from '../../components/ui/Card';

const { venueId } = Astro.params;
const venue = db.select().from(venues).where(eq(venues.id, parseInt(venueId || '0'))).get();

if (!venue) {
  return Astro.redirect('/404');
}
---

<Layout title={`${venue.name} - Parkwood Play`}>
  <Header />
  <main class="pt-20 pb-16">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <div>
          <img 
            src={venue.image || '/images/placeholder.jpg'} 
            alt={venue.name}
            class="w-full h-96 object-cover rounded-lg mb-6"
          />
          <Card className="p-6">
            <h1 class="text-3xl font-bold mb-4">{venue.name}</h1>
            <div class="flex items-center gap-2 mb-4">
              <span class="text-yellow-500">â˜…</span>
              <span class="text-lg">
                {venue.rating?.toFixed(2)} ({venue.reviewCount} reviews)
              </span>
            </div>
            <p class="text-gray-700 mb-4">{venue.description}</p>
            <div class="mb-4">
              <h3 class="font-semibold mb-2">Address</h3>
              <p class="text-gray-600">{venue.address}</p>
            </div>
            {venue.isFeatured && (
              <span class="inline-block bg-primary text-white px-3 py-1 rounded-full text-sm font-medium">
                FEATURED
              </span>
            )}
          </Card>
        </div>
        <div>
          <BookingForm venueId={venue.id} />
        </div>
      </div>
    </div>
  </main>
  <Footer />
</Layout>

